// SDAPWA v1.0.0 - Add Task Screen
const AddTaskScreen={render(a){a.innerHTML='<div class="addtask-screen"><h2>Add Task</h2><div class="task-type-tabs"><button class="task-type-tab active" data-type="time">‚è∞ Time</button><button class="task-type-tab" data-type="location">üìç Location</button></div><div class="task-form active" id="time-form"><div class="form-group"><label>Task Name</label><input type="text" id="task-name" placeholder="e.g., Call the dentist"></div><div class="form-group"><label>Start Time</label><input type="datetime-local" id="task-start"></div><div class="form-group"><label>Duration</label><div class="duration-options"><button class="duration-btn" data-duration="7">7 min</button><button class="duration-btn active" data-duration="15">15 min</button><button class="duration-btn" data-duration="35">35 min</button></div></div><div class="form-group"><label><input type="checkbox" id="bmde-checkbox"> Add to "Before My Day Ends"</label></div><div class="form-group"><button class="btn-secondary" onclick="AddTaskScreen.createTask()">Create Task</button></div></div><div class="task-form" id="location-form"><p>Location-based tasks coming soon!</p></div></div>';this.setupEventListeners()},setupEventListeners(){document.querySelectorAll('.task-type-tab').forEach(b=>b.addEventListener('click',()=>this.switchTab(b.dataset.type)));document.querySelectorAll('.duration-btn').forEach(b=>b.addEventListener('click',()=>this.selectDuration(b)))},switchTab(a){document.querySelectorAll('.task-type-tab').forEach(b=>b.classList.remove('active'));document.querySelectorAll('.task-form').forEach(b=>b.classList.remove('active'));event.target.classList.add('active');document.getElementById(a+'-form').classList.add('active')},selectDuration(a){document.querySelectorAll('.duration-btn').forEach(b=>b.classList.remove('active'));a.classList.add('active')},async createTask(){const a=document.getElementById('task-name').value.trim(),b=document.getElementById('task-start').value,c=document.querySelector('.duration-btn.active').dataset.duration,d=document.getElementById('bmde-checkbox').checked;if(!a){window.App.showToast('Task name required','error');return}try{const e=window.Storage.get(window.CONSTANTS.STORAGE_KEYS.DEVICE_ID),f=new Date(b),g=window.DateTimeUtils.addMinutes(f,parseInt(c)),h=window.Task.newScheduled(a,parseInt(c),f.toISOString(),g.toISOString(),'');h.before_day_ends=d;h.touch(e);const i=window.Auth.getUserId();await window.db.collection('users/'+i+'/tasks').doc(h.id).set(h.toFirestore());window.App.showToast('Task created!','success');window.App.showScreen('dashboard')}catch(a){console.error('Error creating task:',a);window.App.showToast('Failed to create task','error')}}};window.AddTaskScreen=AddTaskScreen;console.log('‚úì AddTaskScreen loaded');
